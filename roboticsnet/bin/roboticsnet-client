#!/usr/bin/env python2.7

import sys
import argparse

from roboticsnet.client.rover_client import RoverClient
from roboticsnet.byte_helpers.queryproc_byte_arr_helper import QueryprocByteArrHelper

# Configuration
parser = argparse.ArgumentParser('Manually send commands to listener.')

parser.add_argument('--move',
        help='send move command, given a value from 0 to 255',
        type=int)

parser.add_argument('--turn',
        help='send turn command, given a value from 0 to 255',
        type=int)

parser.add_argument('--queryproc',
        help='send query about what is currently running',
        action='store_true')

parser.add_argument('--graceful',
        help='shutdown server gracefully',
        action='store_true')

args = parser.parse_args()

# RUN
client = RoverClient()
print "Using port: ", client.getPort()
print "Using host: ", client.getHost()

if args.move:
    print "Send move command..."
    client.move(args.move)
    print "Done!"

elif args.turn:
    print "Send turn command..."
    client.turn(args.turn)
    print "Done!"

elif args.queryproc:
    print "Send query to listener..."
    reply = client.query()
    print "Done!"
    print QueryprocByteArrHelper.format(reply)

elif args.graceful:
    print "Requesting shutdown..."
    client.graceful()
    print "DONE!"

